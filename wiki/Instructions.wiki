#How to use ACONITE

= Introduction =

A description of how to use ACONITE


= Details =

Requirements:
- Fortran compilers.  

   We use GNU compilers for Apple OS X that can be found at http://hpc.sourceforge.net

Recommended 

-  R

 We have provided R code that makes it easier to run ACONITE

To run

1) Compile the code by typing ./build_aconite. If permission denied, type 'chmod u+x build_aconite'

2) Modify the aconite_namelist to customize the simulation.  The following files and inputs are required.  Be sure to include the full path of the files.  
	CLIM_FILE=  :  the daily climate inputs (use the '/input_data' directory)

        PARAM_FILE=  :  the parameter file (use the '/input_data' directory)

        DAY_OUT=   :  Enter a file name here if you want daily outputs (use the '/output' directory)

	ANNUAL_OUT=  :  Enter a file name here if you want annual outputs.  Stocks will be output on the day of year specified by the 'ANNUAL_STATE_DOY' input below (use the '/output' directory)

	RESTART_IN=  :Enter the initial conditions file.  If blank it will use the hard coded defaults which aren't guaranteed to work (use the '/input_data' directory)

	RESTART_OUT=  : Enter a file name if you want the model save an initial condition file for future use (use the '/input_data' directory)

	DIST_IN =  : OPTIONAL: file describing disturbance history (use the '/input_data' directory)
	
	SITE_IN=    : The site level information (use the '/input_data' directory)

	NFERT_IN	: OPTIONAL: file describing the N fertilization experiment (use the '/input_data' directory)

	SOILWARM_IN	: OPTIONAL: file describing the soil warming experiment (use the '/input_data' directory)

	SIM_LENGTH=2000 : This is the total number of years in the simulation

        CLIM_LENGTH=365 : This is the total number of days in the climate input file

	DIST_LENGTH : number of years in the distaff_in file (doesn't include the header)

	NFERT_LENGTH	 : number of years in the nfert_in file (doesn't include the header)

	SOILWARM_LENGTH	: number of years in the soilwarm_in file (doesn't include the header)

	YEAR_OUT_START : the year that output is first saved

        YEAR_OUT_END : the year that output is last saved

	ANNUAL_STATE_DOY=200 : the day of year that stocks are saved in the annual output

	COLD_START=0			     : overwrites the initial stock variables so that C:N are consistent with the parameterized C:N ratios. Rarely used.

	SPINUP_LENGTH=			:  the number of year  	

	SPINUP_CLIM_LENGTH=                 : the number of days of climate data used in the model spin-up

3) Run the compiled code.  ('./run_aconite')

Structure of ACONITE directories

build_aconite:  a bash script to compile code

/src  :  contains the source code and makefile for compiling
_type.f90	declare variables

    aconite_init.f90  : variables allocated, hard wire parameters, zero fluxes, initialize states

    aconite_io.f90	: reads namelist, sets climate, parameter initialization if in namelist, writes output files

   aconite_main.f90  :	loop through time, call initialization functions, calls read climate

   aconite_ecosystem.f90 : processes

   aconite_function.f90	  : repeated functions (photosynthesis, N uptake, etc), error checks, annual updates

   makefile :  used to compile the code

/docs : includes files that help better understand ACONITE
/input_data : parameter files, climate files, disturbance files, site descriptions, etc
/scripts  : R code for running simulations and plotting the results

    To use the scripts:
    1) Open R
    2) Set working directory to be the scripts directory <setwd('directory')>
    3) Type 'Source(run_aconite_decid.r') - or _evergreen or _tropical
    4) Type

	run_aconite(file1,file2,plot_day,total_sim,start,end,annual_doy,spinup_length)
		-file1 = 'daily file' 
		-file2=	'annual file'
                       - plot day = 0 (no) or 1(yes) for daily output
                       -annual_doy = day of year of the stocks 
		- spinup_length = number of years that the model is run before starting the total_sims

            example:
                     run_aconite('','annual out.txt',0,2000,1,2000,200,0)
                     run_aconite('dayout.txt','annual out.txt',1,2000,1999,2000,200,0)


Have fun!
